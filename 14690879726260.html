<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
    
  Linux 软硬链接 - Kid's blog
  
  </title>
  
  
  <link href="atom.xml" rel="alternate" title="Kid's blog" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/foundation.min.css" />
    <link rel="stylesheet" href="asset/css/docs.css" />
    <link rel="icon" href="asset/img/social/favicon.ico">
    <script src="asset/js/vendor/modernizr.js"></script>
    <script src="asset/js/vendor/jquery.js"></script>
  <script src="asset/highlightjs/highlight.pack.js"></script>
  <link href="asset/highlightjs/styles/github.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript">
  function before_search(){
    var searchVal = 'site: ' + document.getElementById('search_input').value;
    document.getElementById('search_q').value = searchVal;
    return true;
  }
</script>
  </head>
  <body class="antialiased hide-extras">
    
    <div class="marketing off-canvas-wrap" data-offcanvas>
      <div class="inner-wrap">


<nav class="top-bar docs-bar hide-for-small" data-topbar>


  <section class="top-bar-section">
  <div class="row">
      <div style="position: relative;width:100%;"><div style="position: absolute; width:100%;">
        <ul id="main-menu" class="left">
        <li id="menu_item_index"><a href="index.html">HOME</a></li>
        <li id="menu_item_archives"><a href="archives.html">Archives</a></li>
        <li id="menu_item_about"><a href="about.html">ABOUT</a></li>
        </ul>

        <ul class="right" id="search-wrap">
          <li>
<form target="_blank" onsubmit="return before_search();" action="http://google.com/search" method="get">
    <input type="hidden" id="search_q" name="q" value="" />
    <input tabindex="1" type="search" id="search_input"  placeholder="Search"/>
</form>
</li>
          </ul>
      </div></div>
  </div>
  </section>

</nav>

        <nav class="tab-bar show-for-small">
  <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
    <span> &nbsp; Kid's blog</span>
  </a>
</nav>

<aside class="left-off-canvas-menu">
      <ul class="off-canvas-list">
       
       <li><a href="index.html">HOME</a></li>
    <li><a href="archives.html">Archives</a></li>
    <li><a href="about.html">ABOUT</a></li>

    <li><label>Categories</label></li>

         

      </ul>
    </aside>

<a class="exit-off-canvas" href="#"></a>


        <section id="main-content" role="main" class="scroll-container">
        
       

 <script type="text/javascript">
  $(function(){
    $('#menu_item_index').addClass('is_active');
  });
</script>
<div class="row">
  <div class="large-8 medium-8 columns">
      <div class="markdown-body article-wrap">
       <div class="article">
          
          <h1>Linux 软硬链接</h1>
     
        <div class="read-more clearfix">
          <span class="date">2015/7/21</span>

          
           
         
          <span class="comments">
            

            
              &nbsp;<a  class="ds-thread-count" data-thread-key="14690879726260.html" data-count-type="comments" href="14690879726260.html#ds-thread"></a>
            
          </span>

        </div>
      </div><!-- article -->

      <div class="article-content">
      <h4 id="toc_0">硬链接</h4>

<ol>
<li>硬链接（实体链接） <code>ln  source  target</code>  例如 <code>ln  hello.txt   hello2.txt</code></li>
<li>当划分磁盘分区并格式化的时候，整个分区会被划分为两个部分，即inode区和data block(实际数据放置在数据区域中）这个inode即是（目录、档案）文件在一个文件系统中的唯一标识,需要访问这个文件的时候必须先找到并读取这个文件的 inode.</li>
<li>Inode 里面存储了文件的很多重要参数，其中唯一标识称作<font color=red>Inumber</font>, 其他信息还有创建时间（ctime）、修改时间(mtime) 、文件大小、<font color=red>属主</font>、归属的用户组、读写<font color=red>权限、数据所在block号</font>等信息。</li>
</ol>

<span id="more"></span><!-- more -->

<ol>
<li><p>通常会根据分区的用途来安排inode的数量（这是另外一个话题了），比如文件数量很多而文件都很小，则需要调增inode较大，以便能索引全部文件。否则将会出现这个分区并没有写满而无法写入任何文件的情况。</p>

<h5 id="toc_1">目录文件与档案文件</h5></li>
<li><p>目录文件：记录该目录下的文件名</p></li>
<li><p>档案文件：记录实际文件数据</p></li>
<li><p><strong>inode本身并不记录文件名，文件名记录在目录文件的block当中</strong>，所以<strong>新增</strong>、<strong>删除</strong>、<strong>更改文件名</strong>与目录的W权限有关。因此当我们要读某个档案时,就务必经过其<font color=blue>目录</font>的inode和block，然后才能够找到<strong>待读取档案的inode号</strong>，最终才会读到<strong>正确的档案block内的数据</strong>。系统是通过<strong>索引节点(而不是文件名)</strong>来定位每一个文件</p></li>
</ol>

<p><font color=purple>目录inode（满足权限？） =&gt; 目录block =&gt; 档案inode（满足权限？） =&gt; 档案block</font></p>

<ol>
<li></li>
<li><p>多个档名对应同一个inode，<strong>硬链接只是在某个目录下新增一笔档名链接到某个inode号码的关联记录而已</strong>。如果将上图中任何其中一个档名删除，档案的inode与block都还存在，依然还可以通过另一个档名来读取正确的档案数据。此外，不论用哪一个档名来编辑，最终的结果都会写入相同的inode和block中，因此均能进行数据的修改。</p></li>
<li><p><font color=red>注意：</font> </p></li>
</ol>

<ul>
<li><p>删除一个指针，链接数同时减一，只有将所有指向文件内容的指针，也即链接数减为0时，内核才会把文件内容从磁盘上删除</p></li>
<li><p><font color=red>不允许给目录创建硬链接。</font></p></li>
<li><p><font color=red>不可以在不同文件系统的文件间建立链接。</font>因为 inode 是这个文件在当前分区中的索引值，是相对于这个分区的，当然不能跨越文件系统了。</p></li>
</ul>

<h4 id="toc_2">软链接</h4>

<ol>
<li><p>软链接（符号链接）<code>ln -s source target</code>  例如  <code>ln -s  MyBook  MyBook1</code></p></li>
<li></li>
<li><p>软连接就是建立一个独立的文件，而这个文件会让数据的读取指向它<font color=red>link的那个档案的档名</font>，由于只是作为指向的动作，所以当来源档案被删除之后，软连接的档案无法开启，因为找不到原始档名。<font color=red>连结档的内容只有档名</font>，根据档名链接到正确的目录进一步取得目标档案的inode，最终就能够读取到正确的数据。如果目标档案的原始档名被删除了那么整个环节就进行不下去了。</p></li>
<li><p><font color=red>软链接克服了硬链接的不足，没有任何文件系统的限制，任何用户可以创建指向目录的符号链接。</font>因而现在更为广泛使用，它具有更大的灵活性，<font color=red>甚至可以跨越不同机器、不同网络对文件进行链接。</font></p></li>
<li><p><strong>软硬链接对比</strong></p></li>
</ol>

<ul>
<li><p>硬链接原文件/链接文件公用一个inode号，说明他们是同一个文件，而软链接原文件/链接文件拥有不同的inode号，表明他们是两个不同的文件；</p></li>
<li><p>在文件属性上软链接明确写出了是链接文件，而硬链接没有写出来，因为在本质上硬链接文件和原文件是完全平等关系；</p></li>
<li><p>链接数目是不一样的，软链接的链接数目不会增加；</p></li>
<li><p><font =color=red>文件大小是不一样的，硬链接文件显示的大小是跟原文件是一样的。而这里软链接显示的大小与原文件就不同了，软链接显示的大小是原文件名的字符对应字节的大小</font></p></li>
<li><p>软链接没有任何文件系统的限制，任何用户可以创建指向目录的符号链接</p></li>
<li><p>建立软链接就是建立了一个<font color=red>新文件</font>。当访问链接文件时，系统就会发现他是个链接文件，它读取链接文件找到真正要访问的文件</p></li>
<li><p><font color=green>当然软链接也有硬链接没有的缺点</font>：因为软链接文件包含有原文件的路径信息，所以当原文件从一个目录下移到其他目录中，再访问软链接文件，系统就找不到了，而硬链接就没有这个缺陷，你想怎么移就怎么移；还有它要系统分配额外的空间用于建立新的索引节点和保存原文件的路径。</p></li>
</ul>

<h4 id="toc_3">用法搭配</h4>

<p><code>ls -i</code> 查找文件的inode number ，然后使用<code>find -inum</code> 查找所有指向该 inode 的文件</p>

<p>例子：<code>$ find . -inum 267105</code></p>

<h4 id="toc_4">删除软链时注意</h4>

<p>当删除已了软链指向的是一个文件夹时，例如 软链  MyBook1 -&gt; MyBook</p>

<p>rm -rf   MyBook1  是删除 MyBook1这个软链</p>

<p>rm -rf   MyBook1/  是删除MyBook 文件夹，但是MyBook1得软链仍然存在</p>

<pre><code>public MainClass(String s) {
  super(s);
  control = new ControlSnake();
  control.setFocusable(true);
  kit = Toolkit.getDefaultToolkit();
  dimen = kit.getScreenSize();

  add(control);
  setLayout(new BorderLayout());
  setLocation(dimen.width / 3, dimen.height / 3);// dimen.width/3,dimen.height/3
  setSize(FWIDTH, FHEIGHT);
  setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
  setResizable(false);
  setVisible(true);
 }

 public static final int FWIDTH = 315;

 public static final int FHEIGHT = 380;
}

import java.util.*;
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import javax.swing.Timer;
import java.util.Random;

@SuppressWarnings(&quot;serial&quot;)
public class ControlSnake extends JPanel implements ActionListener {
 Random rand;

 ArrayList&lt;Point&gt; list, listBody;

 String str, str1;

 static boolean key;

 int x, y, dx, dy, fx, fy, flag;

 int snakeBody;

 int speed;

 public ControlSnake() {
  snakeBody = 1;
</code></pre>

      </div>

      <div class="row">
        <div class="large-6 columns">
        <p class="text-left" style="padding:15px 0px;">
      
        </p>
        </div>
        <div class="large-6 columns">
      <p class="text-right" style="padding:15px 0px;">
      
      </p>
        </div>
      </div>
      <div class="comments-wrap">
        <div class="share-comments">
          

          

          
              <div class="ds-thread" data-thread-key="14690879726260.html" data-url="14690879726260.html" data-title="Linux 软硬链接"></div>
          
        </div>
      </div>
    </div><!-- article-wrap -->
  </div><!-- large 8 -->




 <div class="large-4 medium-4 columns">
  <div class="hide-for-small">
    <div id="sidebar" class="sidebar">
          <div id="site-info" class="site-info">
            
                <div class="site-a-logo"><img src="/Users/kid/Pictures/kid.jpeg" /></div>
            
                <h1>Kid's blog</h1>
                <div class="site-des"></div>
                <div class="social">










<a target="_blank" class="email" href="mailto:284826009@qq.com" title="Email">Email</a>
  <a target="_blank" class="rss" href="atom.xml" title="RSS">RSS</a>
                
              	 </div>
          	</div>

             

              <div id="site-categories" class="side-item ">
                <div class="side-header">
                  <h2>Categories</h2>
                </div>
                <div class="side-content">

      	<p class="cat-list">
         
        </p>


                </div>
              </div>

              <div id="site-categories" class="side-item">
                <div class="side-header">
                  <h2>Recent Posts</h2>
                </div>
                <div class="side-content">
                <ul class="posts-list">
	      
		      
			      <li class="post">
			        <a href="14690879726260.html">Linux 软硬链接</a>
			      </li>
		     
		   
		  		</ul>
                </div>
              </div>
        </div><!-- sidebar -->
      </div><!-- hide for small -->
</div><!-- large 4 -->

</div><!-- row -->

 <div class="page-bottom clearfix">
  <div class="row">
   <p class="copyright">kid's blog &copy; 2015
 &nbsp; 
Theme used <a target="_blank" href="http://github.com">GitHub CSS</a>.</p>
  </div>
</div>

        </section>
      </div>
    </div>

  


<script type="text/javascript">
var duoshuoQuery = {short_name:'1412name'};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
  </script>
    

    <script src="asset/js/foundation.min.js"></script>
    <script>
      $(document).foundation();
      function fixSidebarHeight(){
        var w1 = $('.markdown-body').height();
          var w2 = $('#sidebar').height();
          if (w1 > w2) { $('#sidebar').height(w1); };
      }
      $(function(){
        fixSidebarHeight();
      })
      $(window).load(function(){
          fixSidebarHeight();
      });
     
    </script>

    



  </body>
</html>
